<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Hash [Savon - Heavy metal Ruby SOAP client library]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Hash
        </h1>
        <ol class='paths'>
          <li>
            <a href="../files/lib/savon/core_ext/hash_rb.html">lib/savon/core_ext/hash.rb</a>
            (<a href="http://github.com/rubiii/savon/tree/master/lib/savon/core_ext/hash.rb">view online</a>)
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a href="Object.html">Object</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000006">find_soap_body</a></li>
              <li><a href="#M000008">map_soap_response</a></li>
              <li><a href="#M000007">to_soap_xml</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M000006'>
                <a name='M000006'></a>
                <div class='synopsis'>
                  <span class='name'>find_soap_body</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns the values from the soap:Body element or an empty <a
                  href="Hash.html">Hash</a> in case the soap:Body tag could not be found.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000006-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000006-source'>   <span class="ruby-comment cmt"># File lib/savon/core_ext/hash.rb, line 5</span>&#x000A;5:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find_soap_body</span>&#x000A;6:     <span class="ruby-identifier">envelope</span> = <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">first</span>] <span class="ruby-operator">||</span> {}&#x000A;7:     <span class="ruby-identifier">body_key</span> = <span class="ruby-identifier">envelope</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-regexp re">/.+:Body/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">key</span> } <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>&#x000A;8:     <span class="ruby-identifier">body_key</span> <span class="ruby-value">? </span><span class="ruby-identifier">envelope</span>[<span class="ruby-identifier">body_key</span>].<span class="ruby-identifier">map_soap_response</span> <span class="ruby-operator">:</span> {}&#x000A;9:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000008'>
                <a name='M000008'></a>
                <div class='synopsis'>
                  <span class='name'>map_soap_response</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Maps keys and values of a <a href="Hash.html">Hash</a> created from SOAP
                  response XML to more convenient Ruby Objects.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000008-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000008-source'>    <span class="ruby-comment cmt"># File lib/savon/core_ext/hash.rb, line 74</span>&#x000A;74:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">map_soap_response</span>&#x000A;75:     <span class="ruby-identifier">inject</span>({}) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>&#x000A;76:       <span class="ruby-identifier">value</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">value</span>&#x000A;77:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>   <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">value</span>[<span class="ruby-value str">&quot;xsi:nil&quot;</span>] <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">map_soap_response</span>&#x000A;78:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>  <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">val</span><span class="ruby-operator">|</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">map_soap_response</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-identifier">val</span> }&#x000A;79:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">map_soap_response</span>&#x000A;80:       <span class="ruby-keyword kw">end</span>&#x000A;81: &#x000A;82:       <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">merge</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">strip_namespace</span>.<span class="ruby-identifier">snakecase</span>.<span class="ruby-identifier">to_sym</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">value</span>&#x000A;83:     <span class="ruby-keyword kw">end</span>&#x000A;84:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000007'>
                <a name='M000007'></a>
                <div class='synopsis'>
                  <span class='name'>to_soap_xml</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Translates the <a href="Hash.html">Hash</a> into SOAP request compatible
                  XML.
                  </p>
                  <pre>{ :find_user =&gt; { :id =&gt; 123, &quot;wsdl:Key&quot; =&gt; &quot;api&quot; } }.to_soap_xml&#x000A;# =&gt; &quot;&lt;findUser&gt;&lt;id&gt;123&lt;/id&gt;&lt;wsdl:Key&gt;api&lt;/wsdl:Key&gt;&lt;/findUser&gt;&quot;</pre>
                  <h4>Mapping</h4>
                  <ul>
                  <li><a href="Hash.html">Hash</a> keys specified as Symbols are converted to
                  lowerCamelCase Strings
                  
                  </li>
                  <li><a href="Hash.html">Hash</a> keys specified as Strings are not converted
                  and may contain namespaces
                  
                  </li>
                  <li><a href="DateTime.html">DateTime</a> values are converted to xs:dateTime
                  Strings
                  
                  </li>
                  <li>Objects responding to to_datetime (except Strings) are converted to
                  xs:dateTime Strings
                  
                  </li>
                  <li>TrueClass and FalseClass objects are converted to &#8220;true&#8221; and
                  &#8220;false&#8221; Strings
                  
                  </li>
                  <li>All other objects are expected to be converted to Strings using to_s
                  
                  </li>
                  </ul>
                  <p>
                  An example:
                  </p>
                  <pre>{ :magic_request =&gt; {&#x000A;    :perform_move =&gt; true,&#x000A;    &quot;perform_at&quot; =&gt; DateTime.new(2010, 11, 22, 11, 22, 33)&#x000A;  }&#x000A;}.to_soap_xml&#x000A;&#x000A;&lt;magicRequest&gt;&#x000A;  &lt;performMove&gt;true&lt;/performMove&gt;&#x000A;  &lt;perform_at&gt;2012-06-11T10:42:21&lt;/perform_at&gt;&#x000A;&lt;/magicRequest&gt;</pre>
                  <h4>:order!</h4>
                  <p>
                  In case your service requires the tags to be in a specific order
                  (parameterOrder), you have two options. The first is to specify your body
                  as an XML string. The second is to specify the order through an additional
                  array stored under the <tt>:order!</tt> key.
                  </p>
                  <pre>{ :name =&gt; &quot;Eve&quot;, :id =&gt; 123, :order! =&gt; [:id, :name] }.to_soap_xml&#x000A;# =&gt; &quot;&lt;id&gt;123&lt;/id&gt;&lt;name&gt;Eve&lt;/name&gt;&quot;</pre>
                  <h4>:attributes!</h4>
                  <p>
                  If you need attributes, you could either go with an XML string or add
                  another hash under the <tt>:attributes!</tt> key.
                  </p>
                  <pre>{ :person =&gt; &quot;Eve&quot;, :attributes! =&gt; { :person =&gt; { :id =&gt; 666 } } }.to_soap_xml&#x000A;# =&gt; '&lt;person id=&quot;666&quot;&gt;Eve&lt;/person&gt;'</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000007-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000007-source'>    <span class="ruby-comment cmt"># File lib/savon/core_ext/hash.rb, line 54</span>&#x000A;54:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_soap_xml</span>&#x000A;55:     <span class="ruby-identifier">xml</span> = <span class="ruby-constant">Builder</span><span class="ruby-operator">::</span><span class="ruby-constant">XmlMarkup</span>.<span class="ruby-identifier">new</span>&#x000A;56:     <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:attributes!</span>) <span class="ruby-operator">||</span> {}&#x000A;57: &#x000A;58:     <span class="ruby-identifier">order</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>&#x000A;59:       <span class="ruby-identifier">attrs</span> = <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||</span> {}&#x000A;60:       <span class="ruby-identifier">value</span> = <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">key</span>]&#x000A;61:       <span class="ruby-identifier">key</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_soap_key</span>&#x000A;62: &#x000A;63:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">value</span>&#x000A;64:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">xml</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_soap_xml</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">attrs</span>)&#x000A;65:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>  <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">tag!</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">attrs</span>) { <span class="ruby-identifier">xml</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_soap_xml</span> }&#x000A;66:         <span class="ruby-keyword kw">else</span>            <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">tag!</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">attrs</span>) { <span class="ruby-identifier">xml</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_soap_value</span> }&#x000A;67:       <span class="ruby-keyword kw">end</span>&#x000A;68:     <span class="ruby-keyword kw">end</span>&#x000A;69: &#x000A;70:     <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">target!</span>&#x000A;71:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
